<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shrividya Ravi">
<meta name="dcterms.date" content="2023-06-05">

<title>e-flaneur - Importance of buildings in urban studies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">e-flaneur</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../essays.html" rel="" target="">
 <span class="menu-text">Essays</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/shriv" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ShrividyaRavi" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Importance of buildings in urban studies</h1>
  <div class="quarto-categories">
    <div class="quarto-category">data science</div>
    <div class="quarto-category">urban morphology</div>
    <div class="quarto-category">buildings</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shrividya Ravi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 5, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Buildings and streets, with the occasional punctuation of greenery, define the urban built environment. Our daily trips typically start and end in buildings making them anchors of our activities - from leisure to work to residence. However, streets and roads make a bigger impact as they dictate the efficiency of movement and ultimately, access to amenities and opportunities at the larger urban scale.</p>
<p>Street networks are hierarchical by design <span class="citation" data-cites="RoadHierarchy2023"><a href="#ref-RoadHierarchy2023" role="doc-biblioref">[1]</a></span>. Changes in local streets elicit grumbles from residents but small, sudden changes to critical segments like arterial roads can affect a large number of people at short time scales. We are less mindful of almost all changes that happen to buildings. Construction takes months or years to complete and evolution of use (e.g.&nbsp;more ground floor storefronts) occurs over even longer time scales. These changes are less intrusive in daily lives except for people in the immediate neighbourhood. Instead, changes are reminisced as nostalgic tales of neighbourhood character over the decades.</p>
<p>The perspective that streets are more relevant to our daily lives carries over to the academic where street network analysis is a burgeoning field of research. Papers span a wide range of topics whose scale, split by <em>grain</em> and <em>extent</em> <span class="citation" data-cites="fleischmannMeasuringUrbanForm2021"><a href="#ref-fleischmannMeasuringUrbanForm2021" role="doc-biblioref">[2]</a></span>, directly connects to the relevant real-world applications. Local street network analysis, with low grain (i.e.&nbsp;high spatial resolution) and low extent (spatial coverage), has applications to neighbourhood level walkability <span class="citation" data-cites="simonsNetworkCentralityMeasures2021"><a href="#ref-simonsNetworkCentralityMeasures2021" role="doc-biblioref">[3]</a></span>. Intra-urban analyses tend have larger extent with (typically) high grain for applications like access to opportunities and amenities are relevant to economic and social well-being <span class="citation" data-cites="huangAccessibilityStreetNetwork2020"><a href="#ref-huangAccessibilityStreetNetwork2020" role="doc-biblioref">[4]</a></span>. Due to the coverage of OpenStreetMap (<a href="https://www.openstreetmap.org/">OSM</a>), analyses have the flexibility to focus on a single area or compare multiple parts of world.</p>
<p>Unlike street networks from OSM, building data is not available and /or has quality issues across multiple administrative scales - limiting study even within a single country <span class="citation" data-cites="biljeckiOpenGovernmentGeospatial2021"><a href="#ref-biljeckiOpenGovernmentGeospatial2021" role="doc-biblioref">[5]</a></span>. Furthermore, data is often only available as footprints i.e.&nbsp;the shape on the ground without accompanying useful information like the amenities it houses, number of floors, available dwellings or height. This paucity of information is especially challenging for analysis of urban settlements in the global south - clashing uncomfortably with their higher need.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="building-with-tag-only.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Building in Ghatkhopar, Mumbai with no other information than shape and basic tag in OpenStreetMap.</figcaption><p></p>
</figure>
</div>
<p>Well-designed buildings and neighbourhoods are crucial for sustainable development in the global south. However, the understanding of interventions required for built environment change cannot be obtained with the better datasets and expertise of the global north since urbanism of the global south exhibits distinctive characteristics and statistically different issues <span class="citation" data-cites="nagendraUrbanSouthPredicament2018"><a href="#ref-nagendraUrbanSouthPredicament2018" role="doc-biblioref">[6]</a></span> . For example, buildings anchor large parts of a city in the global south since designed streets don’t exist in informal settlements <span class="citation" data-cites="wangEOMorphometricsUnderstanding2023"><a href="#ref-wangEOMorphometricsUnderstanding2023" role="doc-biblioref">[7]</a></span>. In Mumbai, slums have “gullies”, the informal parlance for extremely narrow alleys, rather than formally managed or designed streets. Given the pervasive slum typologies in the city (e.g.&nbsp;<a href="https://shriv.github.io/e-flaneur/posts/mumbai-slums/">slum map</a>), street network analysis or learnings from a vastly different city like Rotterdam cannot provide any useful insights.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="slum-highrise.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Dense slums contrasting with high development urbanism in Andheri West, Mumbai. Photo by <a href="https://unsplash.com/@alfarnassolkar?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Alfarnas Solkar</a> on <a href="https://unsplash.com/photos/oqjl1kTw_Bo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></figcaption><p></p>
</figure>
</div>
<p>Luckily, open source tools of data science, especially geospatial data science, are now sophisticated enough to tackle problems of data poverty. Tools like <a href="http://docs.momepy.org/en/stable/#"><code>momepy</code></a> can infer considerable insights from small amounts of consistent data. Machine learning methods trained on vast amounts of satellite imagery can generate missing data e.g.&nbsp;adding missing building polygons <span class="citation" data-cites="microsoftGlobalMLBuildingFootprintsWorldwideBuilding"><a href="#ref-microsoftGlobalMLBuildingFootprintsWorldwideBuilding" role="doc-biblioref">[8]</a></span>, inferring building heights <span class="citation" data-cites="tripathyGeneratingMegacityscaleBuilding2022b"><a href="#ref-tripathyGeneratingMegacityscaleBuilding2022b" role="doc-biblioref">[9]</a></span> or measuring levels of inequality in urban areas <span class="citation" data-cites="zhouSatelliteMappingUrban2022"><a href="#ref-zhouSatelliteMappingUrban2022" role="doc-biblioref">[10]</a></span>.</p>
<p>These open source tools offer a unique opportunity for urban enthusiasts and researchers to expand the sparse research on the urban global south. For example, <code>momepy</code> can infer plot area around buildings - which can be used to quantify the amount of unused, private land in Indian cities <span class="citation" data-cites="AlainBertaudBimal"><a href="#ref-AlainBertaudBimal" role="doc-biblioref">[11]</a></span>. Derived building heights from satellite data <span class="citation" data-cites="tripathyGeneratingMegacityscaleBuilding2022b"><a href="#ref-tripathyGeneratingMegacityscaleBuilding2022b" role="doc-biblioref">[9]</a></span> combined with building footprints can be used to evaluate urban planning metrics like the Floor Space Index (FSI). For the ambitious, building these datasets with simple analyses is only the beginning. The data can be used to test urban interventions, like densifying specific locales, or simulating trajectories of change by intervention policy.</p>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-RoadHierarchy2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><span>“Road hierarchy,”</span> <em>Wikipedia</em>. Apr. 18, 2023. Accessed: Jun. 04, 2023. [Online]. Available: <a href="https://en.wikipedia.org/w/index.php?title=Road_hierarchy&amp;oldid=1150514363">https://en.wikipedia.org/w/index.php?title=Road_hierarchy&amp;oldid=1150514363</a></div>
</div>
<div id="ref-fleischmannMeasuringUrbanForm2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">M. Fleischmann, O. Romice, and S. Porta, <span>“Measuring urban form: <span>Overcoming</span> terminological inconsistencies for a quantitative and comprehensive morphologic analysis of cities.”</span> 2021. doi: <a href="https://doi.org/10.1177/2399808320910444">10.1177/2399808320910444</a>.</div>
</div>
<div id="ref-simonsNetworkCentralityMeasures2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">G. D. Simons, <span>“Network centrality measures and their correlation to mixed-uses at the pedestrian-scale,”</span> Jul. 01, 2021. <a href="http://arxiv.org/abs/2106.14040">http://arxiv.org/abs/2106.14040</a> (accessed Dec. 29, 2022).</div>
</div>
<div id="ref-huangAccessibilityStreetNetwork2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">B.-X. Huang, S.-C. Chiou, and W.-Y. Li, <span>“Accessibility and <span>Street Network Characteristics</span> of <span>Urban Public Facility Spaces</span>: <span>Equity Research</span> on <span>Parks</span> in <span>Fuzhou City Based</span> on <span>GIS</span> and <span>Space Syntax Model</span>,”</span> <em>Sustainability</em>, vol. 12, no. 9, p. 3618, Apr. 2020, doi: <a href="https://doi.org/10.3390/su12093618">10.3390/su12093618</a>.</div>
</div>
<div id="ref-biljeckiOpenGovernmentGeospatial2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">F. Biljecki, L. Z. X. Chew, N. Milojevic-Dupont, and F. Creutzig, <span>“Open government geospatial data on buildings for planning sustainable and resilient cities,”</span> Jun. 28, 2021. <a href="http://arxiv.org/abs/2107.04023">http://arxiv.org/abs/2107.04023</a> (accessed Apr. 01, 2023).</div>
</div>
<div id="ref-nagendraUrbanSouthPredicament2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">H. Nagendra, X. Bai, E. S. Brondizio, and S. Lwasa, <span>“The urban south and the predicament of global sustainability,”</span> <em>Nat Sustain</em>, vol. 1, no. 7, pp. 341–349, Jul. 2018, doi: <a href="https://doi.org/10.1038/s41893-018-0101-5">10.1038/s41893-018-0101-5</a>.</div>
</div>
<div id="ref-wangEOMorphometricsUnderstanding2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">J. Wang, M. Fleischmann, A. Venerandi, O. Romice, M. Kuffer, and S. Porta, <span>“<span>EO</span> + <span>Morphometrics</span>: <span>Understanding</span> cities through urban morphology at large scale,”</span> <em>Landscape and Urban Planning</em>, vol. 233, p. 104691, May 2023, doi: <a href="https://doi.org/10.1016/j.landurbplan.2023.104691">10.1016/j.landurbplan.2023.104691</a>.</div>
</div>
<div id="ref-microsoftGlobalMLBuildingFootprintsWorldwideBuilding" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">Microsoft, <span>“<span>GlobalMLBuildingFootprints</span>: <span>Worldwide</span> building footprints derived from satellite imagery.”</span> <a href="https://github.com/microsoft/GlobalMLBuildingFootprints">https://github.com/microsoft/GlobalMLBuildingFootprints</a> (accessed Aug. 07, 2022).</div>
</div>
<div id="ref-tripathyGeneratingMegacityscaleBuilding2022b" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">P. Tripathy, K. Balakrishnan, C. de Franchis, and A. Kumar, <span>“Generating megacity-scale building height maps without <span>DGNSS</span> surveyed <span>GCPs</span>: <span>An</span> open-source approach,”</span> <em>Environment and Planning B: Urban Analytics and City Science</em>, vol. 49, no. 9, pp. 2312–2330, Nov. 2022, doi: <a href="https://doi.org/10.1177/23998083221084990">10.1177/23998083221084990</a>.</div>
</div>
<div id="ref-zhouSatelliteMappingUrban2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">Y. Zhou <em>et al.</em>, <span>“Satellite mapping of urban built-up heights reveals extreme infrastructure gaps and inequalities in the <span>Global South</span>,”</span> <em>Proc. Natl. Acad. Sci. U.S.A.</em>, vol. 119, no. 46, p. e2214813119, Nov. 2022, doi: <a href="https://doi.org/10.1073/pnas.2214813119">10.1073/pnas.2214813119</a>.</div>
</div>
<div id="ref-AlainBertaudBimal" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline"><span>“Alain <span>Bertaud</span>, <span>Bimal Patel</span>, <span>Vidyadhar Phatak</span> on <span>Improving Indian Urban Planning</span> - <span>YouTube</span>.”</span> <a href="https://www.youtube.com/">https://www.youtube.com/</a> (accessed Aug. 06, 2022).</div>
</div>
</div>
</section>
<section id="credits" class="level3">
<h3 class="anchored" data-anchor-id="credits">Credits</h3>
<ul>
<li>Post photo by <a href="https://unsplash.com/de/@mysticalmumbai?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Mystical Mumbai</a> on <a href="https://unsplash.com/photos/zRYDQejPrzw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>